import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.e8ee2c8f.js";const h=JSON.parse('{"title":"DB æ¨¡å‹å’Œ Eloquent","description":"","frontmatter":{},"headers":[],"relativePath":"tips/db-models-and-eloquent.md","filePath":"tips/db-models-and-eloquent.md","lastUpdated":1697532650000}'),p={name:"tips/db-models-and-eloquent.md"},o=l(`<h1 id="db-æ¨¡å‹å’Œ-eloquent" tabindex="-1">DB æ¨¡å‹å’Œ Eloquent <a class="header-anchor" href="#db-æ¨¡å‹å’Œ-eloquent" aria-label="Permalink to &quot;DB æ¨¡å‹å’Œ Eloquent&quot;">â€‹</a></h1><h2 id="orderbyraw-åŸå§‹æŸ¥è¯¢æ’åº" tabindex="-1">orderByRaw åŸå§‹æŸ¥è¯¢æ’åº <a class="header-anchor" href="#orderbyraw-åŸå§‹æŸ¥è¯¢æ’åº" aria-label="Permalink to &quot;orderByRaw åŸå§‹æŸ¥è¯¢æ’åº&quot;">â€‹</a></h2><p>å¯ä»¥ä¼ é€’åŸå§‹æŸ¥è¯¢æ¥å¯¹ç»“æœè¿›è¡Œæ’åºã€‚ ä¾‹å¦‚ï¼ŒæŒ‰ç…§ä»»åŠ¡åœ¨æˆªæ­¢æ—¥æœŸä¹‹å‰å®Œæˆçš„æ—¶é—´å¯¹ä»»åŠ¡è¿›è¡Œæ’åºã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-highlighted-lines vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// æŒ‰ä»»åŠ¡åœ¨æˆªæ­¢æ—¥æœŸä¹‹å‰å®Œæˆå¯¹ä»»åŠ¡è¿›è¡Œæ’åº</span></span>
<span class="line"><span style="color:#79B8FF;">Task</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">query</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">whereNotNull</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;completed_at&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">orderByRaw</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;due_at - completed_at DESC&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light has-highlighted-lines vp-code-light"><code><span class="line"><span style="color:#6A737D;">// æŒ‰ä»»åŠ¡åœ¨æˆªæ­¢æ—¥æœŸä¹‹å‰å®Œæˆå¯¹ä»»åŠ¡è¿›è¡Œæ’åº</span></span>
<span class="line"><span style="color:#005CC5;">Task</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">whereNotNull</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;completed_at&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line highlighted"><span style="color:#24292E;">    </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">orderByRaw</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;due_at - completed_at DESC&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="wherebetween-è·å–ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„æ•°æ®" tabindex="-1">ğ˜„ğ—µğ—²ğ—¿ğ—²ğ—•ğ—²ğ˜ğ˜„ğ—²ğ—²ğ—» è·å–ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„æ•°æ® <a class="header-anchor" href="#wherebetween-è·å–ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„æ•°æ®" aria-label="Permalink to &quot;ğ˜„ğ—µğ—²ğ—¿ğ—²ğ—•ğ—²ğ˜ğ˜„ğ—²ğ—²ğ—» è·å–ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„æ•°æ®&quot;">â€‹</a></h2><p>ä½¿ç”¨ <code>ğ˜„ğ—µğ—²ğ—¿ğ—²ğ—•ğ—²ğ˜ğ˜„ğ—²ğ—²ğ—»</code> åŠ è½½ä¸¤ä¸ªæ—¶é—´æˆ³ä¹‹é—´çš„è®°å½•ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// åŠ è½½ä¸¤ä¸ªæ—¶é—´æˆ³ä¹‹é—´å®Œæˆçš„ä»»åŠ¡</span></span>
<span class="line"><span style="color:#79B8FF;">Task</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereBetween</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;completed_at&#39;</span><span style="color:#E1E4E8;">, [</span></span>
<span class="line"><span style="color:#E1E4E8;">    $request</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">from </span><span style="color:#F97583;">??</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;2023-01-01&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    $request</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">to </span><span style="color:#F97583;">??</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">today</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">toDateTimeString</span><span style="color:#E1E4E8;">(),</span></span>
<span class="line"><span style="color:#E1E4E8;">]);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// åŠ è½½ä¸¤ä¸ªæ—¶é—´æˆ³ä¹‹é—´å®Œæˆçš„ä»»åŠ¡</span></span>
<span class="line"><span style="color:#005CC5;">Task</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereBetween</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;completed_at&#39;</span><span style="color:#24292E;">, [</span></span>
<span class="line"><span style="color:#24292E;">    $request</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">from </span><span style="color:#D73A49;">??</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;2023-01-01&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    $request</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">to </span><span style="color:#D73A49;">??</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">today</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">toDateTimeString</span><span style="color:#24292E;">(),</span></span>
<span class="line"><span style="color:#24292E;">]);</span></span></code></pre></div><h2 id="whereintegerinraw" tabindex="-1">whereIntegerInRaw <a class="header-anchor" href="#whereintegerinraw" aria-label="Permalink to &quot;whereIntegerInRaw&quot;">â€‹</a></h2><p>å½“ç›®æ ‡å€¼ä¸º<strong>æ•´å‹</strong>æ—¶ï¼Œä¸è¦ä½¿ç”¨ <code>ğ˜„ğ—µğ—²ğ—¿ğ—²ğ—œğ—»()</code> æ–¹æ³•åŠ è½½å¤§èŒƒå›´æ•°æ®ï¼Œè€Œæ˜¯ä½¿ç”¨ <code>ğ˜„ğ—µğ—²ğ—¿ğ—²ğ—œğ—»ğ˜ğ—²ğ—´ğ—²ğ—¿ğ—œğ—»ğ—¥ğ—®ğ˜„()</code> æ¯” <code>ğ˜„ğ—µğ—²ğ—¿ğ—²ğ—œğ—»()</code> æ›´å¿«ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line"><span style="color:#F97583;">&lt;?</span><span style="color:#79B8FF;">php</span></span>
<span class="line"></span>
<span class="line diff remove"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereIn</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">range</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">))</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span></span>
<span class="line diff add"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereIntegerInRaw</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">range</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">))</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line"><span style="color:#D73A49;">&lt;?</span><span style="color:#005CC5;">php</span></span>
<span class="line"></span>
<span class="line diff remove"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereIn</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">range</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">50</span><span style="color:#24292E;">))</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span></span>
<span class="line diff add"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereIntegerInRaw</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">range</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">50</span><span style="color:#24292E;">))</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span></span></code></pre></div><h2 id="whereraw-åŸå§‹æŸ¥è¯¢" tabindex="-1">whereRaw åŸå§‹æŸ¥è¯¢ <a class="header-anchor" href="#whereraw-åŸå§‹æŸ¥è¯¢" aria-label="Permalink to &quot;whereRaw åŸå§‹æŸ¥è¯¢&quot;">â€‹</a></h2><p>ä½¿ç”¨åƒ <code>whereRaw()</code> æ–¹æ³•è¿™æ ·çš„ SQL åŸå§‹æŸ¥è¯¢ï¼Œç›´æ¥åœ¨æŸ¥è¯¢ä¸­è¿›è¡Œä¸€äº›ç‰¹å®šäºæ•°æ®åº“çš„è®¡ç®—ï¼Œè€Œä¸æ˜¯åœ¨ Laravel ä¸­ï¼Œé€šå¸¸ç»“æœä¼šæ›´å¿«ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæƒ³è·å¾—æ³¨å†Œå 30 å¤©ä»¥ä¸Šæ´»è·ƒçš„ç”¨æˆ·</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;active&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">whereRaw</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;TIMESTAMPDIFF(DAY, created_at, updated_at) &gt; ?&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">30</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;active&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">whereRaw</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;TIMESTAMPDIFF(DAY, created_at, updated_at) &gt; ?&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">30</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="rawvalue" tabindex="-1">rawValue <a class="header-anchor" href="#rawvalue" aria-label="Permalink to &quot;rawValue&quot;">â€‹</a></h2><p>Laravel 9.37 æœ‰ä¸€ä¸ªæ–°çš„ <code>rawValue()</code> æ–¹æ³•æ¥ä» SQL è¡¨è¾¾å¼ä¸­è·å–å€¼ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$first </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">TripModel</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">orderBy</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;date_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;ASC&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">rawValue</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;YEAR(\`date_at\`)&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$last </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">TripModel</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">orderBy</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;date_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;DESC&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">rawValue</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;YEAR(\`date_at\`)&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$fullname </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">UserModel</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">, $id)</span></span>
<span class="line"><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">rawValue</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;CONCAT(\`first_name\`, &quot; &quot;, \`last_name\`)&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$first </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">TripModel</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">orderBy</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;date_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;ASC&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">rawValue</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;YEAR(\`date_at\`)&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$last </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">TripModel</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">orderBy</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;date_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;DESC&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">rawValue</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;YEAR(\`date_at\`)&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$fullname </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">UserModel</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">, $id)</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">rawValue</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;CONCAT(\`first_name\`, &quot; &quot;, \`last_name\`)&#39;</span><span style="color:#24292E;">);</span></span></code></pre></div><h2 id="scope-å…¶ä»–å…³ç³»çš„æ¨¡å‹èŒƒå›´" tabindex="-1">scope å…¶ä»–å…³ç³»çš„æ¨¡å‹èŒƒå›´ <a class="header-anchor" href="#scope-å…¶ä»–å…³ç³»çš„æ¨¡å‹èŒƒå›´" aria-label="Permalink to &quot;scope å…¶ä»–å…³ç³»çš„æ¨¡å‹èŒƒå›´&quot;">â€‹</a></h2><p>å¯ä»¥ä½¿ç”¨æ¨¡å‹èŒƒå›´æ¥å®šä¹‰ä¸€ä¸ªç›¸å…³çš„æ¨¡å‹å…³è”å…³ç³»ã€‚</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-RIRkF" id="tab-riMnEdw" checked="checked"><label for="tab-riMnEdw">app/Models/Course.php</label><input type="radio" name="group-RIRkF" id="tab-WVh28x_"><label for="tab-WVh28x_">app/Models/Lesson.php</label></div><div class="blocks"><div class="language-php vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-highlighted-lines vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">lessons</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">HasMany</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">hasMany</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">Lesson</span><span style="color:#F97583;">::class</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">publishedLessons</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">HasMany</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">lessons</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">published</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light has-highlighted-lines vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">lessons</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">HasMany</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">hasMany</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">Lesson</span><span style="color:#D73A49;">::class</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">publishedLessons</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">HasMany</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line highlighted"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">lessons</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">published</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">scopePublished</span><span style="color:#E1E4E8;">($query)</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> $query</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;is_published&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">scopePublished</span><span style="color:#24292E;">($query)</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> $query</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;is_published&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div></div><h2 id="å¤šä¸ªæŸ¥è¯¢èŒƒå›´" tabindex="-1">å¤šä¸ªæŸ¥è¯¢èŒƒå›´ <a class="header-anchor" href="#å¤šä¸ªæŸ¥è¯¢èŒƒå›´" aria-label="Permalink to &quot;å¤šä¸ªæŸ¥è¯¢èŒƒå›´&quot;">â€‹</a></h2><p>å¯ä»¥åœ¨ Eloquent æŸ¥è¯¢ä¸­ä½¿ç”¨å¤šä¸ªèŒƒå›´ã€‚</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-MWUK-" id="tab-PSBT2ha" checked="checked"><label for="tab-PSBT2ha">æ§åˆ¶å™¨é€»è¾‘</label><input type="radio" name="group-MWUK-" id="tab-i6h8odr"><label for="tab-i6h8odr">æ¨¡å‹å®šä¹‰</label></div><div class="blocks"><div class="language-php vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">registeredWithinDays</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">30</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">active</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">registeredWithinDays</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">30</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">active</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">scopeActive</span><span style="color:#E1E4E8;">($query) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> $query</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;active&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">scopeRegisteredWithinDays</span><span style="color:#E1E4E8;">($query, $days) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> $query</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;&gt;=&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">subDays</span><span style="color:#E1E4E8;">($days));</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">scopeActive</span><span style="color:#24292E;">($query) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> $query</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;active&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">scopeRegisteredWithinDays</span><span style="color:#24292E;">($query, $days) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> $query</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;&gt;=&#39;</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">subDays</span><span style="color:#24292E;">($days));</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div></div><h2 id="ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡" tabindex="-1">ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡ <a class="header-anchor" href="#ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡" aria-label="Permalink to &quot;ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡&quot;">â€‹</a></h2><p>å¦‚æœæ‰§è¡Œäº†ä¸¤ä¸ªæ•°æ®åº“æ“ä½œï¼Œå®ƒä»¬ä¸­çš„ä¸€ä¸ªå¯èƒ½ä¼šå‡ºé”™ï¼Œæ­¤æ—¶åº”è¯¥å°†ä¸šåŠ¡é€»è¾‘å›æ»šï¼Œå»ºè®®ä½¿ç”¨ <code>DB::transaction()</code>ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">DB</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">transaction</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> () {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">DB</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">table</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;users&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">update</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;votes&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">DB</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">table</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;posts&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">delete</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">DB</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">transaction</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> () {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">DB</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">table</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;users&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;votes&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">DB</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">table</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;posts&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><h2 id="db-aftercommit-äº‹åŠ¡å¤„ç†" tabindex="-1">DB::afterCommit äº‹åŠ¡å¤„ç† <a class="header-anchor" href="#db-aftercommit-äº‹åŠ¡å¤„ç†" aria-label="Permalink to &quot;DB::afterCommit äº‹åŠ¡å¤„ç†&quot;">â€‹</a></h2><p>ä½¿ç”¨ <code>DB::afterCommit()</code> æ–¹æ³•ï¼Œå¯ä»¥ç¼–å†™ä»…åœ¨äº‹åŠ¡æäº¤æ—¶æ‰§è¡Œçš„ä»£ç ï¼Œä»¥åŠåœ¨äº‹åŠ¡å›æ»šæ—¶ä¸¢å¼ƒçš„ä»£ç ã€‚</p><p>å¦‚æœæ²¡æœ‰äº‹åŠ¡æ—¶ï¼Œä»£ç ä¼šç«‹å³æ‰§è¡Œã€‚</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-9e0Hy" id="tab-oOrKO9S" checked="checked"><label for="tab-oOrKO9S">æ¨¡å‹é€»è¾‘</label><input type="radio" name="group-9e0Hy" id="tab-8c9dbEv"><label for="tab-8c9dbEv">ä¸šåŠ¡é€»è¾‘</label></div><div class="blocks"><div class="language-php vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">protected</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">booted</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">static::</span><span style="color:#B392F0;">created</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">self</span><span style="color:#E1E4E8;"> $user) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">// ä»…å½“æ»¡è¶³äº‹åŠ¡å·²æäº¤æ¡ä»¶æ—¶æ‰ä¼šå‘é€ç”µå­é‚®ä»¶</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">DB</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">afterCommit</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> () </span><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> ($user) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">Mail</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WelcomeEmail</span><span style="color:#E1E4E8;">($user));</span></span>
<span class="line"><span style="color:#E1E4E8;">            });</span></span>
<span class="line"><span style="color:#E1E4E8;">        });</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">User</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">protected</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">booted</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">static::</span><span style="color:#6F42C1;">created</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">self</span><span style="color:#24292E;"> $user) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// ä»…å½“æ»¡è¶³äº‹åŠ¡å·²æäº¤æ¡ä»¶æ—¶æ‰ä¼šå‘é€ç”µå­é‚®ä»¶</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">DB</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">afterCommit</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> () </span><span style="color:#D73A49;">use</span><span style="color:#24292E;"> ($user) {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">Mail</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WelcomeEmail</span><span style="color:#24292E;">($user));</span></span>
<span class="line"><span style="color:#24292E;">            });</span></span>
<span class="line"><span style="color:#24292E;">        });</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">DB</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">transaction</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> () {</span></span>
<span class="line"><span style="color:#E1E4E8;">    $user </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">...</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    $user</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">teams</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">...</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">DB</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">transaction</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> () {</span></span>
<span class="line"><span style="color:#24292E;">    $user </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">...</span><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    $user</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">teams</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">...</span><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div></div></div><h2 id="withouttimestamps-æ‰§è¡Œæ“ä½œæ—¶ä¸ä¿®æ”¹-updated-at-å­—æ®µ" tabindex="-1"><code>withoutTimestamps</code> æ‰§è¡Œæ“ä½œæ—¶ä¸ä¿®æ”¹ <code>updated_at</code> å­—æ®µ <a class="header-anchor" href="#withouttimestamps-æ‰§è¡Œæ“ä½œæ—¶ä¸ä¿®æ”¹-updated-at-å­—æ®µ" aria-label="Permalink to &quot;\`withoutTimestamps\` æ‰§è¡Œæ“ä½œæ—¶ä¸ä¿®æ”¹ \`updated_at\` å­—æ®µ&quot;">â€‹</a></h2><p>ä» Laravel 9.31 å¼€å§‹å¯ç”¨ï¼Œå¦‚æœæƒ³åœ¨æ‰§è¡Œæ¨¡å‹æ“ä½œçš„æƒ…å†µä¸‹è®©æ¨¡å‹çš„ <code>Updated_at</code> æ—¶é—´æˆ³ä¸è¢«ä¿®æ”¹ï¼Œå¯ä»¥åœ¨ç»™å®šçš„æ¨¡å‹æ–¹æ³• <code>withoutTimestamps</code> çš„é—­åŒ…å†…å¯¹æ¨¡å‹è¿›è¡Œæ“ä½œã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$user </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">query</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">first</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// \`updated_at\` å­—æ®µå°†ä¸ä¼šå˜æ›´</span></span>
<span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">withoutTimestamps</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> () =&gt; $user</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">update</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;reserved_at&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">()])</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$user </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">first</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// \`updated_at\` å­—æ®µå°†ä¸ä¼šå˜æ›´</span></span>
<span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">withoutTimestamps</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> () =&gt; $user</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;reserved_at&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">()])</span></span>
<span class="line"><span style="color:#24292E;">);</span></span></code></pre></div><h2 id="tobase-åˆå¹¶é›†åˆ" tabindex="-1">toBase() åˆå¹¶é›†åˆ <a class="header-anchor" href="#tobase-åˆå¹¶é›†åˆ" aria-label="Permalink to &quot;toBase() åˆå¹¶é›†åˆ&quot;">â€‹</a></h2><p>Eloquent é›†åˆçš„ <code>merge</code> æ–¹æ³•ä½¿ç”¨ <code>id</code> æ¥é¿å…é‡å¤çš„æ¨¡å‹ã€‚</p><p>ä½†å¦‚æœåˆå¹¶ä¸åŒæ¨¡å‹çš„é›†åˆï¼Œå¯èƒ½ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚</p><p>å»ºè®®æ”¹ç”¨ <code>toBase()</code> æ–¹æ³•ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$videos </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Video</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">all</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">$images </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Image</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">all</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// å¦‚æœå­˜åœ¨ä¸å›¾åƒå…·æœ‰ç›¸åŒ ID çš„è§†é¢‘ï¼Œå®ƒä»¬å°†è¢«æ›¿æ¢ï¼Œæœ€ç»ˆä¼šä¸¢å¤±è§†é¢‘</span></span>
<span class="line"><span style="color:#E1E4E8;">$allMedia </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $videos</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">merge</span><span style="color:#E1E4E8;">($images);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// åœ¨ Eloquent é›†åˆä¸­è°ƒç”¨ \`toBase()\` ä»¥ä½¿ç”¨åŸºæœ¬åˆå¹¶æ–¹æ³•</span></span>
<span class="line"><span style="color:#E1E4E8;">$allMedia </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $videos</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">toBase</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">merge</span><span style="color:#E1E4E8;">($images);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$videos </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Video</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">all</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">$images </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Image</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">all</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// å¦‚æœå­˜åœ¨ä¸å›¾åƒå…·æœ‰ç›¸åŒ ID çš„è§†é¢‘ï¼Œå®ƒä»¬å°†è¢«æ›¿æ¢ï¼Œæœ€ç»ˆä¼šä¸¢å¤±è§†é¢‘</span></span>
<span class="line"><span style="color:#24292E;">$allMedia </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $videos</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">merge</span><span style="color:#24292E;">($images);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// åœ¨ Eloquent é›†åˆä¸­è°ƒç”¨ \`toBase()\` ä»¥ä½¿ç”¨åŸºæœ¬åˆå¹¶æ–¹æ³•</span></span>
<span class="line"><span style="color:#24292E;">$allMedia </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $videos</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">toBase</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">merge</span><span style="color:#24292E;">($images);</span></span></code></pre></div><h2 id="åœ¨-mysql-ä¸Šä½¿ç”¨-laravel-è¿›è¡Œå…¨æ–‡æœç´¢" tabindex="-1">åœ¨ MySQL ä¸Šä½¿ç”¨ Laravel è¿›è¡Œå…¨æ–‡æœç´¢ <a class="header-anchor" href="#åœ¨-mysql-ä¸Šä½¿ç”¨-laravel-è¿›è¡Œå…¨æ–‡æœç´¢" aria-label="Permalink to &quot;åœ¨ MySQL ä¸Šä½¿ç”¨ Laravel è¿›è¡Œå…¨æ–‡æœç´¢&quot;">â€‹</a></h2><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-v5Gn5" id="tab-Q4x13xP" checked="checked"><label for="tab-Q4x13xP">è¿ç§»æ–‡ä»¶</label><input type="radio" name="group-v5Gn5" id="tab-sfu103H"><label for="tab-sfu103H">ä½¿ç”¨æ–¹æ³•</label></div><div class="blocks"><div class="language-php vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-highlighted-lines vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Schema</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;comments&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">Blueprint</span><span style="color:#E1E4E8;"> $table) {</span></span>
<span class="line"><span style="color:#E1E4E8;">     $table</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">     $table</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">string</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;title&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">     $table</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">text</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;description&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">     $table</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">fullText</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;title&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;description&#39;</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light has-highlighted-lines vp-code-light"><code><span class="line"><span style="color:#005CC5;">Schema</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;comments&#39;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">Blueprint</span><span style="color:#24292E;"> $table) {</span></span>
<span class="line"><span style="color:#24292E;">     $table</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">     $table</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">string</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;title&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">     $table</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">text</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line highlighted"><span style="color:#24292E;">     $table</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">fullText</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;title&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// å…¨æ–‡æœç´¢</span></span>
<span class="line"><span style="color:#79B8FF;">Comment</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereFulltext</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;title&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;description&#39;</span><span style="color:#E1E4E8;">], </span><span style="color:#9ECBFF;">&#39;something&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// ä½¿ç”¨ expanded æ‰§è¡Œæ›´å¤§çš„æŸ¥è¯¢</span></span>
<span class="line"><span style="color:#79B8FF;">Comment</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereFulltext</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;title&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;description&#39;</span><span style="color:#E1E4E8;">], </span><span style="color:#9ECBFF;">&#39;something&#39;</span><span style="color:#E1E4E8;">, [</span><span style="color:#9ECBFF;">&#39;expanded&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">])</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// æœç´¢ something å†…å®¹å¹¶æ’é™¤ other å†…å®¹</span></span>
<span class="line"><span style="color:#79B8FF;">Comment</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereFulltext</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;title&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;description&#39;</span><span style="color:#E1E4E8;">], </span><span style="color:#9ECBFF;">&#39;+something -else&#39;</span><span style="color:#E1E4E8;">, [</span><span style="color:#9ECBFF;">&#39;mode&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;boolean&#39;</span><span style="color:#E1E4E8;">])</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// å…¨æ–‡æœç´¢</span></span>
<span class="line"><span style="color:#005CC5;">Comment</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereFulltext</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;title&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&#39;something&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// ä½¿ç”¨ expanded æ‰§è¡Œæ›´å¤§çš„æŸ¥è¯¢</span></span>
<span class="line"><span style="color:#005CC5;">Comment</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereFulltext</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;title&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&#39;something&#39;</span><span style="color:#24292E;">, [</span><span style="color:#032F62;">&#39;expanded&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">])</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// æœç´¢ something å†…å®¹å¹¶æ’é™¤ other å†…å®¹</span></span>
<span class="line"><span style="color:#005CC5;">Comment</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereFulltext</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;title&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&#39;+something -else&#39;</span><span style="color:#24292E;">, [</span><span style="color:#032F62;">&#39;mode&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;boolean&#39;</span><span style="color:#24292E;">])</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div></div></div><h2 id="åŸå§‹æŸ¥è¯¢ä¸­ä½¿ç”¨ç»‘å®š" tabindex="-1">åŸå§‹æŸ¥è¯¢ä¸­ä½¿ç”¨ç»‘å®š <a class="header-anchor" href="#åŸå§‹æŸ¥è¯¢ä¸­ä½¿ç”¨ç»‘å®š" aria-label="Permalink to &quot;åŸå§‹æŸ¥è¯¢ä¸­ä½¿ç”¨ç»‘å®š&quot;">â€‹</a></h2><p>å¯ä»¥å°†ç»‘å®šæ•°ç»„ä¼ é€’ç»™å¤§å¤šæ•°åŸå§‹æŸ¥è¯¢æ–¹æ³•ä»¥é¿å… SQL æ³¨å…¥ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// ä¸‹é¢çš„æ–¹å¼å®¹æ˜“å—åˆ° SQL æ³¨å…¥æ”»å‡»</span></span>
<span class="line diff remove"><span style="color:#E1E4E8;">$fullname </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">request</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;full_name&#39;</span><span style="color:#E1E4E8;">); </span></span>
<span class="line diff remove"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereRaw</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;CONCAT(first_name, last_name) = </span><span style="color:#E1E4E8;">$fullName</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">// ä½¿ç”¨å‚æ•°ç»‘å®š</span></span>
<span class="line diff add"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereRaw</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;CONCAT(first_name, last_name) = ?&quot;</span><span style="color:#E1E4E8;">, [</span><span style="color:#B392F0;">request</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;full_name&#39;</span><span style="color:#E1E4E8;">)])</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line"><span style="color:#6A737D;">// ä¸‹é¢çš„æ–¹å¼å®¹æ˜“å—åˆ° SQL æ³¨å…¥æ”»å‡»</span></span>
<span class="line diff remove"><span style="color:#24292E;">$fullname </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">request</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;full_name&#39;</span><span style="color:#24292E;">); </span></span>
<span class="line diff remove"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereRaw</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;CONCAT(first_name, last_name) = </span><span style="color:#24292E;">$fullName</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">// ä½¿ç”¨å‚æ•°ç»‘å®š</span></span>
<span class="line diff add"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereRaw</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;CONCAT(first_name, last_name) = ?&quot;</span><span style="color:#24292E;">, [</span><span style="color:#6F42C1;">request</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;full_name&#39;</span><span style="color:#24292E;">)])</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span></span></code></pre></div><h2 id="clone-é‡ç”¨æˆ–å…‹éš†æŸ¥è¯¢" tabindex="-1">clone é‡ç”¨æˆ–å…‹éš†æŸ¥è¯¢ <a class="header-anchor" href="#clone-é‡ç”¨æˆ–å…‹éš†æŸ¥è¯¢" aria-label="Permalink to &quot;clone é‡ç”¨æˆ–å…‹éš†æŸ¥è¯¢&quot;">â€‹</a></h2><p>é€šå¸¸ï¼Œåœ¨å¤„ç†å®é™…æŸ¥è¯¢è¯·æ±‚æ—¶éœ€è¦ä»è¿‡æ»¤æŸ¥è¯¢ä¸­è¿›è¡Œå¤šæ¬¡æŸ¥è¯¢ã€‚</p><p>æ‰€ä»¥ï¼Œå¤§å¤šæ•°æ—¶å€™ä¼šä½¿ç”¨ <code>query()</code> æ–¹æ³•ï¼Œ æ¯”å¦‚ç¼–å†™ä¸€ä¸ªæŸ¥è¯¢æ¥è·å–ä»Šå¤©åˆ›å»ºçš„æ´»è·ƒå’Œéæ´»è·ƒäº§å“ï¼š</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-highlighted-lines vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$query </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">query</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">$today </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">request</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">q_date </span><span style="color:#F97583;">??</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">today</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($today) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    $query</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, $today);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#E1E4E8;">$active_products </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $query</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">clone</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;status&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">// å®ƒä¸ä¼šä¿®æ”¹ $query</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">$inactive_products </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $query</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">clone</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;status&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">// æ‰€ä»¥æˆ‘ä»¬å°†ä» $query è·å–éæ´»è·ƒçš„äº§å“</span></span></code></pre><pre class="shiki github-light has-highlighted-lines vp-code-light"><code><span class="line"><span style="color:#24292E;">$query </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">$today </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">request</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">q_date </span><span style="color:#D73A49;">??</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">today</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($today) {</span></span>
<span class="line"><span style="color:#24292E;">    $query</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, $today);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#24292E;">$active_products </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $query</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">clone</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;status&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">// å®ƒä¸ä¼šä¿®æ”¹ $query</span></span>
<span class="line highlighted"><span style="color:#24292E;">$inactive_products </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $query</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">clone</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;status&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">// æ‰€ä»¥æˆ‘ä»¬å°†ä» $query è·å–éæ´»è·ƒçš„äº§å“</span></span></code></pre></div><p>é€šè¿‡é‡ç”¨è¿™ä¸ª <code>$query</code> å¯¹è±¡æ¥è¿›è¡Œå¤šæ¬¡æŸ¥è¯¢ã€‚</p><p>å› æ­¤éœ€è¦åœ¨æ‰§è¡Œä»»ä½• <code>$query</code> ä¿®æ”¹æ“ä½œä¹‹å‰å…‹éš†æ­¤ <code>$query</code>ã€‚</p><h2 id="where-æ—¥æœŸæ–¹æ³•" tabindex="-1">where æ—¥æœŸæ–¹æ³• <a class="header-anchor" href="#where-æ—¥æœŸæ–¹æ³•" aria-label="Permalink to &quot;where æ—¥æœŸæ–¹æ³•&quot;">â€‹</a></h2><p>åœ¨ Eloquent ä¸­ï¼Œä½¿ç”¨å‡½æ•° <code>whereDay()</code>ã€<code>whereMonth()</code>ã€<code>whereYear()</code>ã€<code>whereDate()</code> å’Œ <code>whereTime()</code> æ¥è¿‡æ»¤æ—¥æœŸã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereDay</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;31&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereMonth</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;12&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereYear</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">date</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Y&#39;</span><span style="color:#E1E4E8;">))</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereDate</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;2018-01-31&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereTime</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;=&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;14:13:58&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereDay</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;31&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereMonth</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;12&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereYear</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">date</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;Y&#39;</span><span style="color:#24292E;">))</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereDate</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;2018-01-31&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereTime</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;=&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;14:13:58&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="wheredate" tabindex="-1">whereDate <a class="header-anchor" href="#wheredate" aria-label="Permalink to &quot;whereDate&quot;">â€‹</a></h2><p>ä½¿ç”¨ <code>whereDate()</code> è·å–ä»Šå¤©çš„è®°å½•ï¼Œå¯ä»¥ä½¿ç”¨ <code>Carbon</code> çš„ <code>now()</code> ï¼Œå®ƒä¼šè‡ªåŠ¨è½¬æ¢ä¸ºæ—¥æœŸã€‚æ— éœ€æ‰§è¡Œ <code>-&gt;toDateString()</code> æ–¹æ³•è¿›è¡Œæ—¥æœŸæ ¼å¼çš„è½¬æ¢ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line diff remove"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereDate</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">toDateString</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span></span>
<span class="line diff add"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereDate</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line diff remove"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereDate</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">toDateString</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span></span>
<span class="line diff add"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereDate</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span></span></code></pre></div><h2 id="increments-å’Œ-decrements-å¢å‡æŸä¸ªå­—æ®µ" tabindex="-1">increments å’Œ decrements å¢å‡æŸä¸ªå­—æ®µ <a class="header-anchor" href="#increments-å’Œ-decrements-å¢å‡æŸä¸ªå­—æ®µ" aria-label="Permalink to &quot;increments å’Œ decrements å¢å‡æŸä¸ªå­—æ®µ&quot;">â€‹</a></h2><p>å¦‚æœéœ€è¦æŸä¸ªè¡¨ä¸­çš„æŸäº›æ•°æ®åº“åˆ—ï¼Œåªéœ€ä½¿ç”¨ <code>increment()</code> å‡½æ•°ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Post</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">($post_id)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">increment</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;view_count&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">($user_id)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">increment</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;points&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// ä¸€æ¬¡å¢åŠ  50</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Post</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">($post_id)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">increment</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;view_count&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">($user_id)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">increment</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;points&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">50</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// ä¸€æ¬¡å¢åŠ  50</span></span></code></pre></div><h2 id="æ²¡æœ‰æ—¶é—´æˆ³åˆ—" tabindex="-1">æ²¡æœ‰æ—¶é—´æˆ³åˆ— <a class="header-anchor" href="#æ²¡æœ‰æ—¶é—´æˆ³åˆ—" aria-label="Permalink to &quot;æ²¡æœ‰æ—¶é—´æˆ³åˆ—&quot;">â€‹</a></h2><p>å¦‚æœæ•°æ®åº“è¡¨ä¸åŒ…å«æ—¶é—´æˆ³å­—æ®µ <code>created_at</code> å’Œ <code>updated_at</code>ï¼Œå¯ä»¥è®¾ç½®æ¨¡å‹å±æ€§ <code>$timestamps = false</code> ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Post</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> $timestamps </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Post</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> $timestamps </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="æ›´æ”¹é»˜è®¤æ—¶é—´æˆ³å­—æ®µ" tabindex="-1">æ›´æ”¹é»˜è®¤æ—¶é—´æˆ³å­—æ®µ <a class="header-anchor" href="#æ›´æ”¹é»˜è®¤æ—¶é—´æˆ³å­—æ®µ" aria-label="Permalink to &quot;æ›´æ”¹é»˜è®¤æ—¶é—´æˆ³å­—æ®µ&quot;">â€‹</a></h2><p>å¦‚æœä½¿ç”¨é Laravel æ•°æ®åº“å¹¶ä¸”æ—¶é—´æˆ³åˆ—çš„å‘½åä¸åŒæ€ä¹ˆåŠï¼Ÿæ¯”å¦‚æœ‰ <code>create_time</code> å’Œ <code>update_time</code>ã€‚å¯ä»¥åœ¨æ¨¡å‹ä¸­æŒ‡å®šå®ƒä»¬ï¼š</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Post</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">CREATED_AT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;create_time&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">UPDATED_AT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;update_time&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Post</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">CREATED_AT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;create_time&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">UPDATED_AT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;update_time&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="æ›´æ”¹-created-at-å’Œ-updated-at-çš„æ ¼å¼" tabindex="-1">æ›´æ”¹ created_at å’Œ updated_at çš„æ ¼å¼ <a class="header-anchor" href="#æ›´æ”¹-created-at-å’Œ-updated-at-çš„æ ¼å¼" aria-label="Permalink to &quot;æ›´æ”¹ created_at å’Œ updated_at çš„æ ¼å¼&quot;">â€‹</a></h2><p>å¯ä»¥åœ¨æ¨¡å‹ä¸­æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-lEMoL" id="tab-RgeWJGA" checked="checked"><label for="tab-RgeWJGA">&gt;= Laravel 9</label><input type="radio" name="group-lEMoL" id="tab-YTCHFHm"><label for="tab-YTCHFHm">&lt;= Laravel 8</label></div><div class="blocks"><div class="language-php vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">protected</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">createdAtFormatted</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Attribute</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Attribute</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">make</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> ($value, $attributes) =&gt; $attributes[</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Y-m-d H:i:s&#39;</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    );</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">protected</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">updatedAtFormatted</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Attribute</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Attribute</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">make</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> ($value, $attributes) =&gt; $attributes[</span><span style="color:#9ECBFF;">&#39;updated_at&#39;</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Y-m-d H:i:s&#39;</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    );</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">protected</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">createdAtFormatted</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Attribute</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Attribute</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">make</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> ($value, $attributes) =&gt; $attributes[</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">format</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;Y-m-d H:i:s&#39;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">    );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">protected</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">updatedAtFormatted</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Attribute</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Attribute</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">make</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> ($value, $attributes) =&gt; $attributes[</span><span style="color:#032F62;">&#39;updated_at&#39;</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">format</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;Y-m-d H:i:s&#39;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">    );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getCreatedAtFormattedAttribute</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">created_at</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Y-m-d H:i:s&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getUpdatedAtFormattedAttribute</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">updated_at</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Y-m-d H:i:s&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getCreatedAtFormattedAttribute</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">created_at</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">format</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;Y-m-d H:i:s&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getUpdatedAtFormattedAttribute</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">updated_at</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">format</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;Y-m-d H:i:s&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div></div><p>å¯ä»¥åœ¨éœ€è¦æ—¶ä½¿ç”¨ <code>$entry-&gt;created_at_formatted</code> æˆ–è€… <code>$entry-&gt;updated_at_formatted</code>ã€‚</p><h2 id="è½¯åˆ é™¤æ•°æ®çš„æ¢å¤" tabindex="-1">è½¯åˆ é™¤æ•°æ®çš„æ¢å¤ <a class="header-anchor" href="#è½¯åˆ é™¤æ•°æ®çš„æ¢å¤" aria-label="Permalink to &quot;è½¯åˆ é™¤æ•°æ®çš„æ¢å¤&quot;">â€‹</a></h2><p>åœ¨ä½¿ç”¨æ¨¡å‹çš„è½¯åˆ é™¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>restore()</code> æ–¹æ³•æ¢å¤å¤šè¡Œã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Post</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">onlyTrashed</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;author_id&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">restore</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Post</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">onlyTrashed</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;author_id&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">restore</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="ä½¿ç”¨è½¯åˆ é™¤æŸ¥è¯¢ç”Ÿæˆå™¨" tabindex="-1">ä½¿ç”¨è½¯åˆ é™¤æŸ¥è¯¢ç”Ÿæˆå™¨ <a class="header-anchor" href="#ä½¿ç”¨è½¯åˆ é™¤æŸ¥è¯¢ç”Ÿæˆå™¨" aria-label="Permalink to &quot;ä½¿ç”¨è½¯åˆ é™¤æŸ¥è¯¢ç”Ÿæˆå™¨&quot;">â€‹</a></h2><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// ä¸æ’é™¤è½¯åˆ é™¤çš„æ¡ç›®</span></span>
<span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">withTrashed</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// ä»…è½¯åˆ é™¤æ¡ç›®</span></span>
<span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">onlyTrashed</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// ä¸æ’é™¤è½¯åˆ é™¤çš„æ¡ç›®</span></span>
<span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">withTrashed</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// ä»…è½¯åˆ é™¤æ¡ç›®</span></span>
<span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">onlyTrashed</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="all-æ•°æ®åˆ—" tabindex="-1">all æ•°æ®åˆ— <a class="header-anchor" href="#all-æ•°æ®åˆ—" aria-label="Permalink to &quot;all æ•°æ®åˆ—&quot;">â€‹</a></h2><p>å½“è°ƒç”¨ Eloquent çš„ Model::all() æ—¶ï¼Œå¯ä»¥æŒ‡å®šè¿”å›å“ªäº›åˆ—ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">all</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;name&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;email&#39;</span><span style="color:#E1E4E8;">]);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">all</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;email&#39;</span><span style="color:#24292E;">]);</span></span></code></pre></div><h2 id="firstorfail" tabindex="-1">firstOrFail <a class="header-anchor" href="#firstorfail" aria-label="Permalink to &quot;firstOrFail&quot;">â€‹</a></h2><p>firstOrFail()æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°æŸ¥è¯¢çš„è®°å½•ï¼Œå®ƒä¼šè¿”å›404é¡µé¢ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;email&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;example@example.com&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">firstOrFail</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;email&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;example@example.com&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">firstOrFail</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="æ›´æ”¹åˆ—å" tabindex="-1">æ›´æ”¹åˆ—å <a class="header-anchor" href="#æ›´æ”¹åˆ—å" aria-label="Permalink to &quot;æ›´æ”¹åˆ—å&quot;">â€‹</a></h2><p>åœ¨ Eloquent æŸ¥è¯¢ç”Ÿæˆå™¨ä¸­ï¼Œå¯ä»¥é€šè¿‡â€œasâ€æ¥è¿”å›å…·æœ‰ä¸åŒåç§°çš„ä»»ä½•åˆ—ï¼Œå°±åƒåœ¨æ™®é€š SQL æŸ¥è¯¢ä¸­ä¸€æ ·ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">DB</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">table</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;users&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">select</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;name&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;email as user_email&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">DB</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">table</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;users&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">select</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;email as user_email&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="ä¿®æ”¹æŸ¥è¯¢ç»“æœ" tabindex="-1">ä¿®æ”¹æŸ¥è¯¢ç»“æœ <a class="header-anchor" href="#ä¿®æ”¹æŸ¥è¯¢ç»“æœ" aria-label="Permalink to &quot;ä¿®æ”¹æŸ¥è¯¢ç»“æœ&quot;">â€‹</a></h2><p>Eloquent æŸ¥è¯¢åï¼Œå¯ä»¥ä½¿ç”¨é›†åˆä¸­çš„ <code>map()</code> æ–¹æ³•ä¿®æ”¹è¡Œã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">query</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;active&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">map</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">User</span><span style="color:#E1E4E8;"> $user) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    $user</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">some_column </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">some_function</span><span style="color:#E1E4E8;">($user);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> $user;</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;active&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">map</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">User</span><span style="color:#24292E;"> $user) {</span></span>
<span class="line"><span style="color:#24292E;">    $user</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">some_column </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">some_function</span><span style="color:#24292E;">($user);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> $user;</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><h2 id="latest-æˆ–-oldest-æ’åº" tabindex="-1">latest æˆ– oldest æ’åº <a class="header-anchor" href="#latest-æˆ–-oldest-æ’åº" aria-label="Permalink to &quot;latest æˆ– oldest æ’åº&quot;">â€‹</a></h2><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line diff remove"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">orderBy</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;created_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;desc&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span></span>
<span class="line diff add"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">latest</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line diff remove"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">orderBy</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;created_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;desc&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span></span>
<span class="line diff add"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">latest</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span></span></code></pre></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>latest()</code> æ–¹æ³•å°†æŒ‰ <code>created_at</code> å­—æ®µè¿›è¡Œæ’åºã€‚</p><p>æœ‰ä¸€ä¸ªç›¸åçš„æ–¹æ³• <code>oldest()</code>ï¼Œå®ƒä¼šæŒ‰ <code>created_at</code> å‡åºæ’åºï¼š</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">oldest</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">oldest</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div><p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šå¦ä¸€ä¸ªæ•°æ®åˆ—æ¥æ’åºã€‚ä½¿ç”¨ <code>id</code>ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">latest</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">first</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">latest</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">first</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="åˆ›å»ºè®°å½•æ—¶è‡ªåŠ¨åˆ—å€¼" tabindex="-1">åˆ›å»ºè®°å½•æ—¶è‡ªåŠ¨åˆ—å€¼ <a class="header-anchor" href="#åˆ›å»ºè®°å½•æ—¶è‡ªåŠ¨åˆ—å€¼" aria-label="Permalink to &quot;åˆ›å»ºè®°å½•æ—¶è‡ªåŠ¨åˆ—å€¼&quot;">â€‹</a></h2><p>å¦‚æœæƒ³åœ¨åˆ›å»ºè®°å½•æ—¶ç”Ÿæˆä¸€äº›æ•°æ®åº“åˆ—å€¼ï¼Œè¯·å°†å…¶æ·»åŠ åˆ°æ¨¡å‹çš„ <code>boot()</code> æ–¹æ³•ä¸­ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸€ä¸ª <code>position</code> å­—æ®µå¹¶ä¸”æƒ³è¦å°†ä¸‹ä¸€ä¸ªå¯ç”¨ä½ç½®åˆ†é…ç»™æ–°è®°å½•ï¼ˆä¾‹å¦‚ <code>Country::max(&#39;position&#39;) + 1</code>ï¼‰ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Country</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">protected</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">boot</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">parent::</span><span style="color:#B392F0;">boot</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">Country</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">creating</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;">($model) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            $model</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">position </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Country</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">max</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;position&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        });</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Country</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">protected</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">boot</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">parent::</span><span style="color:#6F42C1;">boot</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">Country</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">creating</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;">($model) {</span></span>
<span class="line"><span style="color:#24292E;">            $model</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">position </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Country</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">max</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;position&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        });</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="groupby-æŒ‰é¦–å­—æ¯åˆ†ç»„" tabindex="-1">groupBy æŒ‰é¦–å­—æ¯åˆ†ç»„ <a class="header-anchor" href="#groupby-æŒ‰é¦–å­—æ¯åˆ†ç»„" aria-label="Permalink to &quot;groupBy æŒ‰é¦–å­—æ¯åˆ†ç»„&quot;">â€‹</a></h2><p>å¯ä»¥åœ¨ <code>groupBy</code> æ¥æ”¶è‡ªå®šä¹‰å›è°ƒä¸­æŒ‰ä»»ä½•è‡ªå®šä¹‰æ¡ä»¶å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œåˆ†ç»„ï¼Œä»¥ä¸‹æ˜¯å¦‚ä½•æŒ‰å…¬å¸åçš„é¦–å­—æ¯è¿›è¡Œåˆ†ç»„</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Company</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">all</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">groupBy</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> ($item) =&gt; $item</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">name[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Company</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">all</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">groupBy</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> ($item) =&gt; $item</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">name[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">);</span></span></code></pre></div><h2 id="ä»ä¸æ›´æ–°åˆ—" tabindex="-1">ä»ä¸æ›´æ–°åˆ— <a class="header-anchor" href="#ä»ä¸æ›´æ–°åˆ—" aria-label="Permalink to &quot;ä»ä¸æ›´æ–°åˆ—&quot;">â€‹</a></h2><p>å¦‚æœæœ‰ä¸€ä¸ªæ•°æ®åº“åˆ—ï¼Œåªæƒ³è®¾ç½®ä¸€æ¬¡å¹¶ä¸”ä¸å†æ›´æ–°ï¼Œå¯ä»¥ä½¿ç”¨ mutator å¯¹æ¨¡å‹è®¾ç½®ã€‚</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-B3BxV" id="tab-FXwtq_c" checked="checked"><label for="tab-FXwtq_c">&gt;= Laravel 9</label><input type="radio" name="group-B3BxV" id="tab-wjIldNe"><label for="tab-wjIldNe">&lt; Laravel 9</label></div><div class="blocks"><div class="language-php vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Illuminate\\Database\\Eloquent\\Casts\\Attribute</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">protected</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">email</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Attribute</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Attribute</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">make</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> ($value, $attributes) =&gt; $attributes[</span><span style="color:#9ECBFF;">&#39;email&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">??</span><span style="color:#E1E4E8;"> $value,</span></span>
<span class="line"><span style="color:#E1E4E8;">        );</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Illuminate\\Database\\Eloquent\\Casts\\Attribute</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">User</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">protected</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">email</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Attribute</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Attribute</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">make</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> ($value, $attributes) =&gt; $attributes[</span><span style="color:#032F62;">&#39;email&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">??</span><span style="color:#24292E;"> $value,</span></span>
<span class="line"><span style="color:#24292E;">        );</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setEmailAttribute</span><span style="color:#E1E4E8;">($value)</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">isset</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">attributes[</span><span style="color:#9ECBFF;">&#39;email&#39;</span><span style="color:#E1E4E8;">]) </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">is_null</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">attributes[</span><span style="color:#9ECBFF;">&#39;email&#39;</span><span style="color:#E1E4E8;">])) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">attributes[</span><span style="color:#9ECBFF;">&#39;email&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $value;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">User</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setEmailAttribute</span><span style="color:#24292E;">($value)</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">isset</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">attributes[</span><span style="color:#032F62;">&#39;email&#39;</span><span style="color:#24292E;">]) </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">is_null</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">attributes[</span><span style="color:#032F62;">&#39;email&#39;</span><span style="color:#24292E;">])) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">attributes[</span><span style="color:#032F62;">&#39;email&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $value;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div></div><h2 id="æŸ¥æ‰¾æ•°ç»„" tabindex="-1">æŸ¥æ‰¾æ•°ç»„ <a class="header-anchor" href="#æŸ¥æ‰¾æ•°ç»„" aria-label="Permalink to &quot;æŸ¥æ‰¾æ•°ç»„&quot;">â€‹</a></h2><p><code>find()</code> å¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ï¼Œç„¶åå®ƒè¿”å›æ‰¾åˆ°çš„æ‰€æœ‰è®°å½•çš„ Collectionï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ª Modelï¼š</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// è¿”å› Eloquent æ¨¡å‹</span></span>
<span class="line"><span style="color:#E1E4E8;">$user </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// è¿”å› Eloquent é›†åˆ</span></span>
<span class="line"><span style="color:#E1E4E8;">$users </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">([</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">]);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// è¿”å› Eloquent æ¨¡å‹</span></span>
<span class="line"><span style="color:#24292E;">$user </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// è¿”å› Eloquent é›†åˆ</span></span>
<span class="line"><span style="color:#24292E;">$users </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">([</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">]);</span></span></code></pre></div><p>ä½¿ç”¨ <code>find()</code> æ›¿æ¢ <code>whereIn()</code>ï¼š</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line diff remove"><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereIn</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">productIDs)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(); </span></span>
<span class="line diff add"><span style="color:#79B8FF;">Product</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">productIDs); </span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line diff remove"><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereIn</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">productIDs)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(); </span></span>
<span class="line diff add"><span style="color:#005CC5;">Product</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">productIDs); </span></span></code></pre></div><h2 id="æŸ¥æ‰¾å¤šä¸ªå¹¶è¿”å›ç‰¹å®šåˆ—" tabindex="-1">æŸ¥æ‰¾å¤šä¸ªå¹¶è¿”å›ç‰¹å®šåˆ— <a class="header-anchor" href="#æŸ¥æ‰¾å¤šä¸ªå¹¶è¿”å›ç‰¹å®šåˆ—" aria-label="Permalink to &quot;æŸ¥æ‰¾å¤šä¸ªå¹¶è¿”å›ç‰¹å®šåˆ—&quot;">â€‹</a></h2><p><code>find()</code> å¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ï¼Œç„¶åè¿”å›æŒ‡å®šåˆ—æ‰¾åˆ°çš„æ‰€æœ‰è®°å½•çš„é›†åˆï¼Œè€Œä¸æ˜¯æ¨¡å‹çš„æ‰€æœ‰åˆ—ï¼š</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// å°†ä»…è¿”å›åŒ…å«åå­—å’Œç”µå­é‚®ä»¶çš„ Eloquent æ¨¡å‹</span></span>
<span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, [</span><span style="color:#9ECBFF;">&#39;first_name&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;email&#39;</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// å°†ä»…è¿”å›åŒ…å«åå­—å’Œç”µå­é‚®ä»¶çš„ Eloquent Collection</span></span>
<span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">find</span><span style="color:#E1E4E8;">([</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">], [</span><span style="color:#9ECBFF;">&#39;first_name&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;email&#39;</span><span style="color:#E1E4E8;">]);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// å°†ä»…è¿”å›åŒ…å«åå­—å’Œç”µå­é‚®ä»¶çš„ Eloquent æ¨¡å‹</span></span>
<span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, [</span><span style="color:#032F62;">&#39;first_name&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;email&#39;</span><span style="color:#24292E;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// å°†ä»…è¿”å›åŒ…å«åå­—å’Œç”µå­é‚®ä»¶çš„ Eloquent Collection</span></span>
<span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">([</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">], [</span><span style="color:#032F62;">&#39;first_name&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;email&#39;</span><span style="color:#24292E;">]);</span></span></code></pre></div><h2 id="wherekey-æŒ‰ä¸»é”®æŸ¥æ‰¾" tabindex="-1">whereKey æŒ‰ä¸»é”®æŸ¥æ‰¾ <a class="header-anchor" href="#wherekey-æŒ‰ä¸»é”®æŸ¥æ‰¾" aria-label="Permalink to &quot;whereKey æŒ‰ä¸»é”®æŸ¥æ‰¾&quot;">â€‹</a></h2><p>ä½¿ç”¨ <code>whereKey()</code> æ–¹æ³•æŸ¥æ‰¾å¤šä¸ªè®°å½•ï¼Œè¯¥æ–¹æ³•è´Ÿè´£ç¡®å®šå“ªä¸ªå­—æ®µæ­£æ˜¯æ‚¨çš„ä¸»é”®ï¼ˆid æ˜¯é»˜è®¤å€¼ï¼Œä½†å¯ä»¥åœ¨ Eloquent æ¨¡å‹ä¸­è¦†ç›–å®ƒï¼‰</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">whereKey</span><span style="color:#E1E4E8;">([</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">])</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">whereKey</span><span style="color:#24292E;">([</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">])</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="ä½¿ç”¨-uuid-ä»£æ›¿è‡ªåŠ¨é€’å¢" tabindex="-1">ä½¿ç”¨ UUID ä»£æ›¿è‡ªåŠ¨é€’å¢ <a class="header-anchor" href="#ä½¿ç”¨-uuid-ä»£æ›¿è‡ªåŠ¨é€’å¢" aria-label="Permalink to &quot;ä½¿ç”¨ UUID ä»£æ›¿è‡ªåŠ¨é€’å¢&quot;">â€‹</a></h2><p>åœ¨æ¨¡å‹ä¸­ä½¿ç”¨è‡ªåŠ¨é€’å¢ IDã€‚</p><p>è¿ç§»æ–‡ä»¶ï¼š</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Schema</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;users&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">Blueprint</span><span style="color:#E1E4E8;"> $table) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// $table-&gt;increments(&#39;id&#39;);</span></span>
<span class="line"><span style="color:#E1E4E8;">    $table</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">uuid</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">unique</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Schema</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;users&#39;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">Blueprint</span><span style="color:#24292E;"> $table) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// $table-&gt;increments(&#39;id&#39;);</span></span>
<span class="line"><span style="color:#24292E;">    $table</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">uuid</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">unique</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-V_8rL" id="tab-fU-02Qo" checked="checked"><label for="tab-fU-02Qo">&gt;= Laravel 9</label><input type="radio" name="group-V_8rL" id="tab-p77la0G"><label for="tab-p77la0G">&lt;= Laravel 8 and PHP &gt;= 7.4.0</label><input type="radio" name="group-V_8rL" id="tab-lvonTCD"><label for="tab-lvonTCD">&lt;= Laravel 8 and PHP &lt; 7.4.0</label></div><div class="blocks"><div class="language-php vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-highlighted-lines vp-code-dark"><code><span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Illuminate\\Database\\Eloquent\\Concerns\\HasUuids</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Illuminate\\Database\\Eloquent\\Model</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Article</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">HasUuids</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">$article </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Article</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;title&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;Traveling to Europe&#39;</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">$article</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">id; </span><span style="color:#6A737D;">// &quot;8f8e8478-9035-4d23-b9a7-62f4d2612ce5&quot;</span></span></code></pre><pre class="shiki github-light has-highlighted-lines vp-code-light"><code><span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Illuminate\\Database\\Eloquent\\Concerns\\HasUuids</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Illuminate\\Database\\Eloquent\\Model</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Article</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line highlighted"><span style="color:#24292E;">    </span><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">HasUuids</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">$article </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Article</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;title&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Traveling to Europe&#39;</span><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">$article</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">id; </span><span style="color:#6A737D;">// &quot;8f8e8478-9035-4d23-b9a7-62f4d2612ce5&quot;</span></span></code></pre></div><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Illuminate\\Support\\Str</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Illuminate\\Database\\Eloquent\\Model</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> $incrementing </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">protected</span><span style="color:#E1E4E8;"> $keyType </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;string&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">protected</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">boot</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">parent::</span><span style="color:#B392F0;">boot</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">self::</span><span style="color:#B392F0;">creating</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">User</span><span style="color:#E1E4E8;"> $model) =&gt; $model</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">attributes[</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Str</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">uuid</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">self::</span><span style="color:#B392F0;">saving</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">User</span><span style="color:#E1E4E8;"> $model) =&gt; $model</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">attributes[</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Str</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">uuid</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Illuminate\\Support\\Str</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Illuminate\\Database\\Eloquent\\Model</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">User</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> $incrementing </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">protected</span><span style="color:#24292E;"> $keyType </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;string&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">protected</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">boot</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">parent::</span><span style="color:#6F42C1;">boot</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">self::</span><span style="color:#6F42C1;">creating</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">User</span><span style="color:#24292E;"> $model) =&gt; $model</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">attributes[</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Str</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">uuid</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">self::</span><span style="color:#6F42C1;">saving</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">User</span><span style="color:#24292E;"> $model) =&gt; $model</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">attributes[</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Str</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">uuid</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Illuminate\\Support\\Str</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Illuminate\\Database\\Eloquent\\Model</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> $incrementing </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">protected</span><span style="color:#E1E4E8;"> $keyType </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;string&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">protected</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">boot</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">parent::</span><span style="color:#B392F0;">boot</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">self::</span><span style="color:#B392F0;">creating</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> ($model) {</span></span>
<span class="line"><span style="color:#E1E4E8;">             $model</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">attributes[</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Str</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">uuid</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        });</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">self::</span><span style="color:#B392F0;">saving</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> ($model) {</span></span>
<span class="line"><span style="color:#E1E4E8;">             $model</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">attributes[</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Str</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">uuid</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        });</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Illuminate\\Support\\Str</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Illuminate\\Database\\Eloquent\\Model</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">User</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> $incrementing </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">protected</span><span style="color:#24292E;"> $keyType </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;string&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">protected</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">boot</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">parent::</span><span style="color:#6F42C1;">boot</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">self::</span><span style="color:#6F42C1;">creating</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> ($model) {</span></span>
<span class="line"><span style="color:#24292E;">             $model</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">attributes[</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Str</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">uuid</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        });</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">self::</span><span style="color:#6F42C1;">saving</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> ($model) {</span></span>
<span class="line"><span style="color:#24292E;">             $model</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">attributes[</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Str</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">uuid</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        });</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div></div><h2 id="addselect-å­æŸ¥è¯¢" tabindex="-1">addSelect å­æŸ¥è¯¢ <a class="header-anchor" href="#addselect-å­æŸ¥è¯¢" aria-label="Permalink to &quot;addSelect å­æŸ¥è¯¢&quot;">â€‹</a></h2><p>ä» Laravel 6 å¼€å§‹ï¼Œå¯ä»¥åœ¨ Eloquent è¯­å¥ä¸­ä½¿ç”¨ <code>addSelect()</code>ï¼Œå¹¶å¯¹æ·»åŠ çš„åˆ—è¿›è¡Œä¸€äº›è®¡ç®—ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Destination</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">addSelect</span><span style="color:#E1E4E8;">([</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;last_flight&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Flight</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">select</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;name&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">whereColumn</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;destination_id&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;destinations.id&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">orderBy</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;arrived_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;desc&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">limit</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">])</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Destination</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">addSelect</span><span style="color:#24292E;">([</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;last_flight&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Flight</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">select</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">whereColumn</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;destination_id&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;destinations.id&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">orderBy</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;arrived_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;desc&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">limit</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">])</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="makehidden-éšè—åˆ—" tabindex="-1">makeHidden éšè—åˆ— <a class="header-anchor" href="#makehidden-éšè—åˆ—" aria-label="Permalink to &quot;makeHidden éšè—åˆ—&quot;">â€‹</a></h2><p>åœ¨è¿›è¡Œ Eloquent æŸ¥è¯¢æ—¶ï¼Œå¦‚æœæƒ³éšè—ç‰¹å®šå­—æ®µä¸è¢«è¿”å›ï¼Œæœ€å¿«çš„æ–¹æ³•ä¹‹ä¸€æ˜¯åœ¨ Collection ç»“æœä¸Šæ·»åŠ  <code>-&gt;makeHidden()</code> æ–¹æ³•ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">User</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">all</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">makeHidden</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;email_verified_at&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;deleted_at&#39;</span><span style="color:#E1E4E8;">]);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">User</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">all</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">makeHidden</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;email_verified_at&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;deleted_at&#39;</span><span style="color:#24292E;">]);</span></span></code></pre></div><h2 id="æ•è·sqlé”™è¯¯" tabindex="-1">æ•è·SQLé”™è¯¯ <a class="header-anchor" href="#æ•è·sqlé”™è¯¯" aria-label="Permalink to &quot;æ•è·SQLé”™è¯¯&quot;">â€‹</a></h2><p>å¦‚æœæƒ³æ•è· Eloquent Query å¼‚å¸¸ï¼Œè¯·ä½¿ç”¨ç‰¹å®šçš„ QueryException è€Œä¸æ˜¯é»˜è®¤çš„ Exception ç±»ï¼Œå°†èƒ½å¤Ÿè·å¾—é”™è¯¯çš„ç¡®åˆ‡ SQL ä»£ç </p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// Some Eloquent/SQL statement</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">\\Illuminate\\Database\\QueryException</span><span style="color:#E1E4E8;"> $e) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($e</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">getCode</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;23000&#39;</span><span style="color:#E1E4E8;">) { </span><span style="color:#6A737D;">// integrity constraint violation</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">back</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">withError</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Invalid data&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// Some Eloquent/SQL statement</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">\\Illuminate\\Database\\QueryException</span><span style="color:#24292E;"> $e) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($e</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">getCode</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;23000&#39;</span><span style="color:#24292E;">) { </span><span style="color:#6A737D;">// integrity constraint violation</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">back</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">withError</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;Invalid data&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="db-statement-æŸ¥è¯¢æ–¹å¼" tabindex="-1">DB::statement() æŸ¥è¯¢æ–¹å¼ <a class="header-anchor" href="#db-statement-æŸ¥è¯¢æ–¹å¼" aria-label="Permalink to &quot;DB::statement() æŸ¥è¯¢æ–¹å¼&quot;">â€‹</a></h2><p>å¦‚æœéœ€è¦æ‰§è¡Œä¸€ä¸ªç®€å•çš„ SQL æŸ¥è¯¢ï¼Œä½†æ²¡æœ‰å¾—åˆ°ä»»ä½•ç»“æœã€‚</p><p>æ¯”å¦‚æ›´æ”¹æ•°æ®åº“ä¸­çš„æŸäº›å†…å®¹ï¼Œå¯ä»¥åªæ‰§è¡Œ <code>DB::statement()</code></p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">DB</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">statement</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;DROP TABLE users&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">DB</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">statement</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#F97583;">ALTER</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#9ECBFF;"> projects AUTO_INCREMENT</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">123</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">DB</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">statement</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;DROP TABLE users&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">DB</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">statement</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;</span><span style="color:#D73A49;">ALTER</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#032F62;"> projects AUTO_INCREMENT</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">123</span><span style="color:#032F62;">&#39;</span><span style="color:#24292E;">);</span></span></code></pre></div><h2 id="updateorcreate-æ›´æ–°æˆ–åˆ›å»º" tabindex="-1"><code>updateOrCreate</code> æ›´æ–°æˆ–åˆ›å»º <a class="header-anchor" href="#updateorcreate-æ›´æ–°æˆ–åˆ›å»º" aria-label="Permalink to &quot;\`updateOrCreate\` æ›´æ–°æˆ–åˆ›å»º&quot;">â€‹</a></h2><p>éœ€è¦æ£€æŸ¥è®°å½•æ˜¯å¦å­˜åœ¨ï¼Œç„¶åæ›´æ–°å®ƒï¼Œæˆ–è€…åˆ›å»ºä¸€æ¡æ–°è®°å½•ã€‚</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-r3ijb" id="tab-9EpyXIZ" checked="checked"><label for="tab-9EpyXIZ">updateOrCreate æ–¹æ³•</label><input type="radio" name="group-r3ijb" id="tab-Yq1srIC"><label for="tab-Yq1srIC">æ—§çš„æ–¹å¼</label></div><div class="blocks"><div class="language-php vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Flight</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">updateOrCreate</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#9ECBFF;">&#39;departure&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;Oakland&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;destination&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;San Diego&#39;</span><span style="color:#E1E4E8;">],</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#9ECBFF;">&#39;price&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">99</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;discounted&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Flight</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">updateOrCreate</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#032F62;">&#39;departure&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Oakland&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;destination&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;San Diego&#39;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#032F62;">&#39;price&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">99</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;discounted&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">);</span></span></code></pre></div><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Flight</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;departure&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;Oakland&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;destination&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;San Diego&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">first</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($flight) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    $flight</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">update</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;price&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">99</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;discounted&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    $flight </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Flight</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">([</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;departure&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;Oakland&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;destination&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;San Diego&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;price&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">99</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;discounted&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">    ]);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Flight</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;departure&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;Oakland&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;destination&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;San Diego&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">first</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($flight) {</span></span>
<span class="line"><span style="color:#24292E;">    $flight</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;price&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">99</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;discounted&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    $flight </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Flight</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">([</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;departure&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Oakland&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;destination&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;San Diego&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;price&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">99</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;discounted&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">    ]);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div></div><h2 id="ä¿å­˜æ—¶æ¸…ç©ºç¼“å­˜" tabindex="-1">ä¿å­˜æ—¶æ¸…ç©ºç¼“å­˜ <a class="header-anchor" href="#ä¿å­˜æ—¶æ¸…ç©ºç¼“å­˜" aria-label="Permalink to &quot;ä¿å­˜æ—¶æ¸…ç©ºç¼“å­˜&quot;">â€‹</a></h2><p>å¦‚æœæœ‰åƒæä¾›é›†åˆçš„å¸–å­è¿™æ ·çš„ç¼“å­˜é”®ï¼Œå¹¶ä¸”æƒ³åœ¨æ–°å»ºæˆ–æ›´æ–°æ—¶å¿˜è®°è¯¥ç¼“å­˜é”®ï¼Œå¯ä»¥åœ¨æ¨¡å‹ä¸Šè°ƒç”¨é™æ€ä¿å­˜çš„å‡½æ•°ï¼š</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Post</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// å­˜å‚¨æˆ–æ›´æ–°æ—¶å¿˜è®°ç¼“å­˜é”®</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">boot</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">parent::</span><span style="color:#B392F0;">boot</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">static::</span><span style="color:#B392F0;">saved</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> () {</span></span>
<span class="line"><span style="color:#E1E4E8;">           </span><span style="color:#79B8FF;">Cache</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">forget</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;posts&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        });</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Post</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// å­˜å‚¨æˆ–æ›´æ–°æ—¶å¿˜è®°ç¼“å­˜é”®</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">boot</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">parent::</span><span style="color:#6F42C1;">boot</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">static::</span><span style="color:#6F42C1;">saved</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> () {</span></span>
<span class="line"><span style="color:#24292E;">           </span><span style="color:#005CC5;">Cache</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">forget</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;posts&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        });</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="replicate-å¤åˆ¶æ¨¡å‹" tabindex="-1">replicate å¤åˆ¶æ¨¡å‹ <a class="header-anchor" href="#replicate-å¤åˆ¶æ¨¡å‹" aria-label="Permalink to &quot;replicate å¤åˆ¶æ¨¡å‹&quot;">â€‹</a></h2><p>å¦‚æœæœ‰ä¸¤ä¸ªéå¸¸ç›¸ä¼¼çš„æ¨¡å‹ï¼ˆä¾‹å¦‚é€è´§åœ°å€å’Œå¸å•åœ°å€ï¼‰å¹¶ä¸”éœ€è¦å°†ä¸€ä¸ªæ¨¡å‹å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ¨¡å‹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>replicate()</code> æ–¹æ³•å¹¶éšåæ›´æ”¹ä¸€äº›å±æ€§ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$shipping </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Address</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">([</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;type&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;shipping&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;line_1&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;123 Example Street&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;city&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;Victorville&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;state&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;CA&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;postcode&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;90001&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">$billing </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $shipping</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">replicate</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">fill</span><span style="color:#E1E4E8;">([</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;type&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;billing&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">$billing</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$shipping </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Address</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">([</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;shipping&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;line_1&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;123 Example Street&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;city&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Victorville&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;state&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;CA&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;postcode&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;90001&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">$billing </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $shipping</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">replicate</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">fill</span><span style="color:#24292E;">([</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;billing&#39;</span></span>
<span class="line"><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">$billing</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">();</span></span></code></pre></div><h2 id="forcefill-å¼ºåˆ¶å¡«å……" tabindex="-1">forceFill å¼ºåˆ¶å¡«å…… <a class="header-anchor" href="#forcefill-å¼ºåˆ¶å¡«å……" aria-label="Permalink to &quot;forceFill å¼ºåˆ¶å¡«å……&quot;">â€‹</a></h2><p>å¿½ç•¥ <code>$fillable</code> çš„é…ç½®å¹¶æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$team</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">forceFill</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&#39;name&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> $request</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">name])</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$team</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">forceFill</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> $request</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">name])</span></span></code></pre></div><h2 id="å¤±è´¥æ—¶æ‰§è¡Œä»»ä½•æ“ä½œ" tabindex="-1">å¤±è´¥æ—¶æ‰§è¡Œä»»ä½•æ“ä½œ <a class="header-anchor" href="#å¤±è´¥æ—¶æ‰§è¡Œä»»ä½•æ“ä½œ" aria-label="Permalink to &quot;å¤±è´¥æ—¶æ‰§è¡Œä»»ä½•æ“ä½œ&quot;">â€‹</a></h2><p>æŸ¥æ‰¾è®°å½•æ—¶ï¼Œå¦‚æœæœªæ‰¾åˆ°ï¼Œå¯èƒ½éœ€è¦æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰çš„æ“ä½œã€‚</p><p>é™¤äº† <code>-&gt;firstOrFail()</code>æ–¹æ³•æŠ›å‡º 404 ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åœ¨å¤±è´¥æ—¶ä½¿ç”¨ <code>-&gt;firstOr(function() { ... })</code>ã€‚</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Flight</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">where</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;legs&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;&gt;&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">firstOr</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> () {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Flight</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">where</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;legs&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;&gt;&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">firstOr</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> () {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div>`,147),e=[o];function t(c,r,y,E,i,d){return a(),n("div",null,e)}const u=s(p,[["render",t]]);export{h as __pageData,u as default};
