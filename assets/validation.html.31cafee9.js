import{r as t,o,c,b as n,a as p,F as l,e,d as s}from"./app.c26b4df5.js";import{_ as i}from"./plugin-vue_export-helper.21dcd24c.js";const r={},u=e(`<h1 id="validation-\u9A8C\u8BC1" tabindex="-1"><a class="header-anchor" href="#validation-\u9A8C\u8BC1" aria-hidden="true">#</a> Validation \u9A8C\u8BC1</h1><h2 id="dimensions-\u56FE\u7247\u9A8C\u8BC1" tabindex="-1"><a class="header-anchor" href="#dimensions-\u56FE\u7247\u9A8C\u8BC1" aria-hidden="true">#</a> <code>dimensions</code> \u56FE\u7247\u9A8C\u8BC1</h2><p>\u5728\u9A8C\u8BC1\u4E0A\u4F20\u7684\u56FE\u50CF\u65F6\uFF0C\u53EF\u4EE5\u6307\u5B9A\u4E0A\u4F20\u56FE\u7247\u6240\u9700\u7684\u5C3A\u5BF8\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;photo&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;dimensions:max_width=4096,max_height=4096&#39;</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="\u81EA\u5B9A\u4E49\u9A8C\u8BC1\u9519\u8BEF\u6D88\u606F" tabindex="-1"><a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u9A8C\u8BC1\u9519\u8BEF\u6D88\u606F" aria-hidden="true">#</a> \u81EA\u5B9A\u4E49\u9A8C\u8BC1\u9519\u8BEF\u6D88\u606F</h2><p>\u53EF\u4EE5\u81EA\u5B9A\u4E49\u6BCF\u4E2A\u5B57\u6BB5\u3001\u89C4\u5219\u548C\u8BED\u8A00\u7684\u9A8C\u8BC1\u9519\u8BEF\u6D88\u606F - \u53EA\u9700\u521B\u5EFA\u5177\u6709\u9002\u5F53\u6570\u7EC4\u7ED3\u6784\u7684\u7279\u5B9A\u8BED\u8A00\u6587\u4EF6 <code>resources/lang/xx/validation.php</code>\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// \u89C4\u5219</span>
<span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> 

<span class="token comment">// \u9519\u8BEF\u4FE1\u606F</span>
<span class="token string single-quoted-string">&#39;custom&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
     <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;required&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;\u8BF7\u63D0\u4F9B\u90AE\u7BB1\u5730\u5740\uFF01&#39;</span><span class="token punctuation">,</span>
     <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="\u7528-now-\u6216-yesterday-\u9A8C\u8BC1\u65E5\u671F" tabindex="-1"><a class="header-anchor" href="#\u7528-now-\u6216-yesterday-\u9A8C\u8BC1\u65E5\u671F" aria-hidden="true">#</a> \u7528 <code>now</code> \u6216 <code>yesterday</code> \u9A8C\u8BC1\u65E5\u671F</h2><p>\u53EF\u4EE5\u901A\u8FC7\u4E4B\u524D/\u4E4B\u540E\u7684\u89C4\u5219\u9A8C\u8BC1\u65E5\u671F\uFF0C\u5E76\u5C06\u5404\u79CD\u5B57\u7B26\u4E32\u4F5C\u4E3A\u53C2\u6570\u4F20\u9012\u3002</p><p>\u4F8B\u5982\uFF1A<code>tomorrw</code>\u3001<code>now</code>\u3001<code>yesterday</code>\u3002\u793A\u4F8B\uFF1A<code>&#39;start_date&#39; =&gt; &#39;after:now&#39;</code>\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$rules</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;start_date&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;after:tomorrow&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;end_date&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;after:start_date&#39;</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="mac-address" tabindex="-1"><a class="header-anchor" href="#mac-address" aria-hidden="true">#</a> <code>mac_address</code></h2><p>Laravel 8.77 \u7248\u672C\u4E4B\u540E\uFF0C\u6DFB\u52A0 <code>mac_address</code> \u89C4\u5219\u9A8C\u8BC1\u6570\u636E\u662F\u5426\u4E3A\u6B63\u786E\u7684 mac \u5730\u5740\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token class-name static-context">Validator</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token string single-quoted-string">&#39;device_mac&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;04:98:77:44:0f:e6&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
  <span class="token string single-quoted-string">&#39;device_mac&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;mac_address&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">passes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Validator</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token string single-quoted-string">&#39;device_mac&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;invalid-mac-address&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
  <span class="token string single-quoted-string">&#39;device_mac&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;mac_address&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">passes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br><br><div class="highlight-line">\xA0</div><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div>`,14),k=s("\u66F4\u591A\u8BE6\u60C5\u67E5\u770B: "),d={href:"https://github.com/laravel/framework/pull/40098",target:"_blank",rel:"noopener noreferrer"},b=s("Added rule to validate MAC address (#40098)"),g=e(`<h2 id="\u6709\u6761\u4EF6\u7684\u9A8C\u8BC1\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#\u6709\u6761\u4EF6\u7684\u9A8C\u8BC1\u89C4\u5219" aria-hidden="true">#</a> \u6709\u6761\u4EF6\u7684\u9A8C\u8BC1\u89C4\u5219</h2><p>\u5982\u679C\u9A8C\u8BC1\u89C4\u5219\u53D6\u51B3\u4E8E\u67D0\u4E9B\u6761\u4EF6\uFF0C\u53EF\u4EE5\u901A\u8FC7\u5C06 <code>withValidator()</code> \u6DFB\u52A0\u5230 <code>FormRequest</code> \u7C7B\u6765\u4FEE\u6539\u89C4\u5219\uFF0C\u5E76\u5728\u90A3\u91CC\u6307\u5B9A\u81EA\u5B9A\u4E49\u903B\u8F91\u3002</p><p>\u4F8B\u5982\uFF0C\u5982\u679C\u53EA\u60F3\u4E3A\u67D0\u4E9B\u7528\u6237\u89D2\u8272\u6DFB\u52A0\u9A8C\u8BC1\u89C4\u5219\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Validation<span class="token punctuation">\\</span>Validator</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CategoryStoreRequest</span> <span class="token keyword">extends</span> <span class="token class-name">FormRequest</span>
<span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">withValidator</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Validator</span> <span class="token variable">$validator</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">isSuperAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$validator</span><span class="token operator">-&gt;</span><span class="token function">addRules</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                <span class="token string single-quoted-string">&#39;some_secret_password&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="prepareforvalidation-\u9A8C\u8BC1\u524D" tabindex="-1"><a class="header-anchor" href="#prepareforvalidation-\u9A8C\u8BC1\u524D" aria-hidden="true">#</a> <code>prepareForValidation</code> \u9A8C\u8BC1\u524D</h2><p>\u5982\u679C\u60F3\u5728\u9ED8\u8BA4 Laravel \u9A8C\u8BC1\u4E4B\u524D\u4FEE\u6539\u67D0\u4E9B\u5B57\u6BB5\uFF0C\u6216\u8005\u6362\u53E5\u8BDD\u8BF4\uFF0C\u201C\u51C6\u5907\u201D\u8BE5\u5B57\u6BB5\uFF0C\u5728 <code>FormRequest</code> \u7C7B\u4E2D\u6709\u4E00\u4E2A\u65B9\u6CD5 <code>prepareForValidation()</code>\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">prepareForValidation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;slug&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name class-name-fully-qualified static-context">Illuminate<span class="token punctuation">\\</span>Support<span class="token punctuation">\\</span>Str</span><span class="token operator">::</span><span class="token function">slug</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">slug</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="\u66F4\u6539\u9ED8\u8BA4\u9A8C\u8BC1\u6D88\u606F" tabindex="-1"><a class="header-anchor" href="#\u66F4\u6539\u9ED8\u8BA4\u9A8C\u8BC1\u6D88\u606F" aria-hidden="true">#</a> \u66F4\u6539\u9ED8\u8BA4\u9A8C\u8BC1\u6D88\u606F</h2><p>\u5982\u679C\u60F3\u66F4\u6539\u7279\u5B9A\u5B57\u6BB5\u548C\u7279\u5B9A\u9A8C\u8BC1\u89C4\u5219\u7684\u9ED8\u8BA4\u9A8C\u8BC1\u9519\u8BEF\u6D88\u606F\uFF0C\u53EA\u9700\u5C06 <code>messages()</code> \u65B9\u6CD5\u6DFB\u52A0\u5230\u60A8\u7684 <code>FormRequest</code> \u7C7B\u4E2D\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name-definition class-name">UserStoreRequest</span> <span class="token keyword">extends</span> <span class="token class-name">FormRequest</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">rules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">messages</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;name.required&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;\u8BF7\u8F93\u5165\u60A8\u7684\u540D\u5B57&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="\u5728\u7B2C\u4E00\u6B21\u9A8C\u8BC1\u5931\u8D25\u65F6\u505C\u6B62" tabindex="-1"><a class="header-anchor" href="#\u5728\u7B2C\u4E00\u6B21\u9A8C\u8BC1\u5931\u8D25\u65F6\u505C\u6B62" aria-hidden="true">#</a> \u5728\u7B2C\u4E00\u6B21\u9A8C\u8BC1\u5931\u8D25\u65F6\u505C\u6B62</h2><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C<code>Laravel</code> \u9A8C\u8BC1\u9519\u8BEF\u5C06\u5728\u5217\u8868\u4E2D\u8FD4\u56DE\uFF0C\u68C0\u67E5\u6240\u6709\u9A8C\u8BC1\u89C4\u5219\u3002</p><p>\u4F46\u662F\uFF0C\u5982\u679C\u60A8\u5E0C\u671B\u8FDB\u7A0B\u5728\u7B2C\u4E00\u4E2A\u9519\u8BEF\u540E\u505C\u6B62\uFF0C\u8BF7\u4F7F\u7528\u540D\u4E3A <code>bail</code> \u7684\u9A8C\u8BC1\u89C4\u5219\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;bail|required|unique:posts|max:255&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;body&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u5982\u679C\u9700\u8981\u5728 <code>FormRequest</code> \u7C7B\u4E2D\u7684\u7B2C\u4E00\u4E2A\u9519\u8BEF\u4E0A\u505C\u6B62\u9A8C\u8BC1\uFF0C\u53EF\u4EE5\u5C06 <code>stopOnFirstFailure</code> \u5C5E\u6027\u8BBE\u7F6E\u4E3A <code>true</code>\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">protected</span> <span class="token variable">$stopOnFirstFailure</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,16),m={href:"https://laravel.com/docs/9.x/validation#stopping-on-first-validation-failure",target:"_blank",rel:"noopener noreferrer"},h=s("Stopping on first validation failure"),q=e(`<h2 id="\u5728\u4E0D\u4F7F\u7528-validate-\u6216-formrequest-\u7684\u60C5\u51B5\u4E0B\u629B\u51FA-422-\u72B6\u6001\u7801" tabindex="-1"><a class="header-anchor" href="#\u5728\u4E0D\u4F7F\u7528-validate-\u6216-formrequest-\u7684\u60C5\u51B5\u4E0B\u629B\u51FA-422-\u72B6\u6001\u7801" aria-hidden="true">#</a> \u5728\u4E0D\u4F7F\u7528 <code>validate()</code> \u6216 <code>FormRequest</code> \u7684\u60C5\u51B5\u4E0B\u629B\u51FA 422 \u72B6\u6001\u7801</h2><p>\u5982\u679C\u4E0D\u4F7F\u7528 <code>validate()</code> \u6216 <code>FormRequest</code>\uFF0C\u4F46\u4ECD\u9700\u8981\u629B\u51FA\u5177\u6709\u76F8\u540C <code>422</code> \u72B6\u6001\u7801\u548C\u9519\u8BEF\u7ED3\u6784\u7684\u9519\u8BEF\uFF0C\u5219\u53EF\u4EE5\u624B\u52A8\u629B\u51FA <code>ValidationException::withMessages()</code> \u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$user</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token class-name static-context">Hash</span><span class="token operator">::</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token class-name static-context">ValidationException</span><span class="token operator">::</span><span class="token function">withMessages</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;The provided credentials are incorrect.&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="\u89C4\u5219\u6761\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u89C4\u5219\u6761\u4EF6" aria-hidden="true">#</a> \u89C4\u5219\u6761\u4EF6</h2><p>\u5982\u679C\u89C4\u5219\u662F\u52A8\u6001\u7684\u5E76\u4E14\u53D6\u51B3\u4E8E\u5176\u4ED6\u6761\u4EF6\uFF0C\u53EF\u4EE5\u5373\u65F6\u521B\u5EFA\u8BE5\u89C4\u5219\u6570\u7EC4</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">store</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$validationArray</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;company&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;logo&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;file|max:2048&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;location&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;apply_link&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required|url&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;content&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;payment_method_id&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$validationArray</span> <span class="token operator">=</span> <span class="token function">array_merge</span><span class="token punctuation">(</span><span class="token variable">$validationArray</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required|email|unique:users&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;password&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required|confirmed|min:5&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="\u4F7F\u7528-rule-when-\u53EF\u4EE5\u6709\u6761\u4EF6\u5730\u5E94\u7528\u9A8C\u8BC1\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-rule-when-\u53EF\u4EE5\u6709\u6761\u4EF6\u5730\u5E94\u7528\u9A8C\u8BC1\u89C4\u5219" aria-hidden="true">#</a> \u4F7F\u7528 <code>Rule::when()</code> \u53EF\u4EE5\u6709\u6761\u4EF6\u5730\u5E94\u7528\u9A8C\u8BC1\u89C4\u5219</h2><p>\u53EF\u4EE5\u6709\u6761\u4EF6\u5730\u5728 <code>laravel</code> \u4E2D\u5E94\u7528\u9A8C\u8BC1\u89C4\u5219\u3002\u5728\u6B64\u793A\u4F8B\u4E2D\uFF0C\u4EC5\u5728\u7528\u6237\u53EF\u4EE5\u5B9E\u9645\u6295\u7968\u5E16\u5B50\u65F6\u9A8C\u8BC1\u6295\u7968\u7684\u4EF7\u503C\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Validation<span class="token punctuation">\\</span>Rule</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">rules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;vote&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">Rule</span><span class="token operator">::</span><span class="token function">when</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">can</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;vote&#39;</span><span class="token punctuation">,</span> <span class="token variable">$post</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;int&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;between:1,5&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="unique-\u4E0D\u8003\u8651\u5E94\u7528\u4E8E\u6A21\u578B\u7684-softdeletes-\u5168\u5C40\u8303\u56F4" tabindex="-1"><a class="header-anchor" href="#unique-\u4E0D\u8003\u8651\u5E94\u7528\u4E8E\u6A21\u578B\u7684-softdeletes-\u5168\u5C40\u8303\u56F4" aria-hidden="true">#</a> <code>unique</code> \u4E0D\u8003\u8651\u5E94\u7528\u4E8E\u6A21\u578B\u7684 <code>SoftDeletes</code> \u5168\u5C40\u8303\u56F4</h2><p>\u5947\u602A\u7684\u662F\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B <code>Rule::unique</code> \u4E0D\u8003\u8651\u5E94\u7528\u4E8E\u6A21\u578B\u7684 <code>SoftDeletes</code> \u5168\u5C40\u8303\u56F4\u3002\u4F46\u662F <code>withoutTrashed()</code> \u65B9\u6CD5\u662F\u53EF\u7528\u7684\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token class-name static-context">Rule</span><span class="token operator">::</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;email&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">withoutTrashed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="validator-sometimes-\u65B9\u6CD5\u5141\u8BB8\u6211\u4EEC\u5B9A\u4E49\u4F55\u65F6\u5E94\u7528\u9A8C\u8BC1\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#validator-sometimes-\u65B9\u6CD5\u5141\u8BB8\u6211\u4EEC\u5B9A\u4E49\u4F55\u65F6\u5E94\u7528\u9A8C\u8BC1\u89C4\u5219" aria-hidden="true">#</a> <code>Validator::sometimes()</code> \u65B9\u6CD5\u5141\u8BB8\u6211\u4EEC\u5B9A\u4E49\u4F55\u65F6\u5E94\u7528\u9A8C\u8BC1\u89C4\u5219</h2><p>Laravel <code>Validator::sometimes()</code> \u65B9\u6CD5\u5141\u8BB8\u6211\u4EEC\u6839\u636E\u63D0\u4F9B\u7684\u8F93\u5165\u5B9A\u4E49\u4F55\u65F6\u5E94\u7528\u9A8C\u8BC1\u89C4\u5219\u3002</p><p>\u4F8B\u5982\uFF1A\u8BE5\u7247\u6BB5\u663E\u793A\u4E86\u5982\u679C\u8D2D\u4E70\u7684\u5546\u54C1\u6570\u91CF\u4E0D\u8DB3\uFF0C\u5982\u4F55\u7981\u6B62\u4F7F\u7528\u4F18\u60E0\u5238\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;coupon&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;PIZZA_PARTY&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;items&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;quantity&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">2</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;quantity&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token variable">$validator</span> <span class="token operator">=</span> <span class="token class-name static-context">Validator</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;coupon&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;exists:coupons,name&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;items&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required|array&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;items.*.id&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required|int&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;items.*.quantity&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required|int&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$validator</span><span class="token operator">-&gt;</span><span class="token function">sometimes</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;coupon&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;prohibited&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">Fluent</span> <span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">collect</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token operator">-&gt;</span><span class="token property">items</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;quantity&#39;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// throws a ValidationException as the quantity provided is not enough</span>
<span class="token variable">$validator</span><span class="token operator">-&gt;</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="\u6570\u7EC4\u5143\u7D20\u9A8C\u8BC1" tabindex="-1"><a class="header-anchor" href="#\u6570\u7EC4\u5143\u7D20\u9A8C\u8BC1" aria-hidden="true">#</a> \u6570\u7EC4\u5143\u7D20\u9A8C\u8BC1</h2><p>\u5982\u679C\u60F3\u9A8C\u8BC1\u63D0\u4EA4\u7684\u6570\u7EC4\u7684\u5143\u7D20\uFF0C\u8BF7\u5728\u5E26\u6709\u201C*\u201D\u7684\u89C4\u5219\u4E2D\u4F7F\u7528\u70B9\u8868\u793A\u6CD5</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// say you have this array</span>
<span class="token comment">// array in request &#39;user_info&#39;</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">validated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token property">user_info</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Qasim&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;age&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">26</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Ahmed&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;age&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">23</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Rule</span>
<span class="token variable">$rules</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;user_info.*.name&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;alpha&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;user_info.*.age&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;numeric&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="password-defaults-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#password-defaults-\u65B9\u6CD5" aria-hidden="true">#</a> <code>Password::defaults</code> \u65B9\u6CD5</h2><p>\u5728\u9A8C\u8BC1\u7528\u6237\u63D0\u4F9B\u7684\u5BC6\u7801\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528 <code>Password::defaults</code> \u65B9\u6CD5\u5F3A\u5236\u6267\u884C\u7279\u5B9A\u89C4\u5219\u3002</p><p>\u5B83\u5305\u62EC\u8981\u6C42\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u7B26\u53F7\u7B49\u7684\u9009\u9879\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name-definition class-name">AppServiceProvider</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token class-name static-context">Password</span><span class="token operator">::</span><span class="token function">defaults</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name static-context">Password</span><span class="token operator">::</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">letters</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">numbers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">symbols</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">mixedCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">uncompromised</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;password&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span> <span class="token class-name static-context">Password</span><span class="token operator">::</span><span class="token function">defaults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="\u9A8C\u8BC1\u91CD\u5B9A\u5411\u7684\u8868\u5355\u8BF7\u6C42" tabindex="-1"><a class="header-anchor" href="#\u9A8C\u8BC1\u91CD\u5B9A\u5411\u7684\u8868\u5355\u8BF7\u6C42" aria-hidden="true">#</a> \u9A8C\u8BC1\u91CD\u5B9A\u5411\u7684\u8868\u5355\u8BF7\u6C42</h2><p>\u5F53\u4F7F\u7528\u8868\u5355\u8BF7\u6C42\u8FDB\u884C\u9A8C\u8BC1\u65F6\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u9A8C\u8BC1\u9519\u8BEF\u5C06\u91CD\u5B9A\u5411\u56DE\u4E0A\u4E00\u6B65\uFF0C\u53EF\u4EE5\u901A\u8FC7\u5B9A\u4E49 <code>$redirect</code> \u6216 <code>$redirectRoute</code> \u7684\u5C5E\u6027\u5373\u53EF\u8986\u76D6\u5B83\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// The URI that users should be redirected to if validation fails./</span>
<span class="token keyword">protected</span> <span class="token variable">$redirect</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;/dashboard&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// The route that users should be redirected to if validation fails.</span>
<span class="token keyword">protected</span> <span class="token variable">$redirectRoute</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;dashboard&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="\u6570\u7EC4\u9A8C\u8BC1\u89C4\u5219-required-array-keys" tabindex="-1"><a class="header-anchor" href="#\u6570\u7EC4\u9A8C\u8BC1\u89C4\u5219-required-array-keys" aria-hidden="true">#</a> \u6570\u7EC4\u9A8C\u8BC1\u89C4\u5219 <code>required_array_keys</code></h2><p><code>Laravel 8.82</code> \u6DFB\u52A0\u4E86 <code>required_array_keys</code> \u9A8C\u8BC1\u89C4\u5219\u3002</p><p>\u8BE5\u89C4\u5219\u68C0\u67E5\u6570\u7EC4\u4E2D\u662F\u5426\u5B58\u5728\u6240\u6709\u6307\u5B9A\u7684\u952E\u3002\u5C06\u901A\u8FC7\u9A8C\u8BC1\u7684\u6709\u6548\u6570\u636E\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;baz&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;foo&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;bar&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;fee&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;faa&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;laa&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;lee&#39;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token variable">$rules</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;baz&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;array&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;required_array_keys:foo,fee,laa&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token variable">$validator</span> <span class="token operator">=</span> <span class="token class-name static-context">Validator</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$rules</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$validator</span><span class="token operator">-&gt;</span><span class="token function">passes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>\u9A8C\u8BC1\u5931\u8D25\u7684\u65E0\u6548\u6570\u636E\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;baz&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;foo&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;bar&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;fee&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;faa&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token variable">$rules</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;baz&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;array&#39;</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;required_array_keys:foo,fee,laa&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token variable">$validator</span> <span class="token operator">=</span> <span class="token class-name static-context">Validator</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$rules</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$validator</span><span class="token operator">-&gt;</span><span class="token function">passes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="\u9A8C\u8BC1\u6D88\u606F\u4E2D\u5B9A\u4F4D\u5360\u4F4D\u7B26" tabindex="-1"><a class="header-anchor" href="#\u9A8C\u8BC1\u6D88\u606F\u4E2D\u5B9A\u4F4D\u5360\u4F4D\u7B26" aria-hidden="true">#</a> \u9A8C\u8BC1\u6D88\u606F\u4E2D\u5B9A\u4F4D\u5360\u4F4D\u7B26</h2><p>\u5728 Laravel 9 \u4E2D\uFF0C\u5982\u679C\u4F7F\u7528\u6570\u7EC4\uFF0C\u5219\u53EF\u4EE5\u5728\u9A8C\u8BC1\u6D88\u606F\u4E2D\u4F7F\u7528 <code>:position</code> \u5360\u4F4D\u7B26\u3002 \u8FD9\u5C06\u8F93\u51FA\uFF1A\u201C\u8BF7\u63D0\u4F9B\u4EF7\u683C #2 \u7684\u91D1\u989D\u201D</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name-definition class-name">CreateProductRequest</span> <span class="token keyword">extends</span> <span class="token class-name">FormRequest</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">rules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span>  <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;string&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token string single-quoted-string">&#39;description&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;nullable&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;sometimes&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;string&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;prices&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;array&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;prices.*.amount&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;numeric&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;prices.*.expired_at&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">messages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span>
    <span class="token punctuation">{</span>
        <span class="token string single-quoted-string">&#39;prices.*.amount.required&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Please provide an amount for price #:position&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div>`,35),v={href:"https://laravel.com/docs/9.x/validation#error-message-indexes-and-positions",target:"_blank",rel:"noopener noreferrer"},f=s("Error message indexes and positions");function y(w,x){const a=t("ExternalLinkIcon");return o(),c(l,null,[u,n("p",null,[k,n("a",d,[b,p(a)])]),g,n("p",null,[n("a",m,[h,p(a)])]),q,n("p",null,[n("a",v,[f,p(a)])])],64)}var R=i(r,[["render",y]]);export{R as default};
