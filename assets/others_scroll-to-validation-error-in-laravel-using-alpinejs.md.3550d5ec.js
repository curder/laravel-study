import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.16715cb7.js";const p="/laravel-study/assets/screenshot.36a03121.png",C=JSON.parse('{"title":"使用 Alpine.js 滚动到验证错误","description":"","frontmatter":{},"headers":[],"relativePath":"others/scroll-to-validation-error-in-laravel-using-alpinejs.md","filePath":"others/scroll-to-validation-error-in-laravel-using-alpinejs.md","lastUpdated":1700556136000}'),o={name:"others/scroll-to-validation-error-in-laravel-using-alpinejs.md"},e=l('<h1 id="使用-alpine-js-滚动到验证错误" tabindex="-1">使用 Alpine.js 滚动到验证错误 <a class="header-anchor" href="#使用-alpine-js-滚动到验证错误" aria-label="Permalink to &quot;使用 Alpine.js 滚动到验证错误&quot;">​</a></h1><p><img src="'+p+`" alt=""></p><p>Laravel 有一个名为 <code>@error</code> 的简洁模版指令，可以使用它来显示给定字段的验证错误消息。</p><p>例如，如果表单中有一个 <code>username</code> 字段，并且想显示它的验证错误消息，可以这样做：</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;">div</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;">label</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class=</span><span style="color:#9ECBFF;">&quot;...&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">for=</span><span style="color:#9ECBFF;">&quot;username&quot;</span><span style="color:#F97583;">&gt;</span><span style="color:#79B8FF;">用户名</span><span style="color:#F97583;">&lt;/</span><span style="color:#79B8FF;">label</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;">input</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">wire</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">model</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;username&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">           </span><span style="color:#F97583;">class=</span><span style="color:#9ECBFF;">&quot;...&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">           </span><span style="color:#79B8FF;">id</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;username&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">type</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">name</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;username&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">value</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#F97583;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">@</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;username&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;">p</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class=</span><span style="color:#9ECBFF;">&quot;text-sm text-red-600 space-y-1 mt-2&quot;</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">{{ $message }}</span><span style="color:#F97583;">&lt;/</span><span style="color:#79B8FF;">p</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">@</span><span style="color:#79B8FF;">enderror</span></span>
<span class="line"><span style="color:#F97583;">&lt;/</span><span style="color:#79B8FF;">div</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">&lt;</span><span style="color:#005CC5;">div</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;</span><span style="color:#005CC5;">label</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class=</span><span style="color:#032F62;">&quot;...&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">for=</span><span style="color:#032F62;">&quot;username&quot;</span><span style="color:#D73A49;">&gt;</span><span style="color:#005CC5;">用户名</span><span style="color:#D73A49;">&lt;/</span><span style="color:#005CC5;">label</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;</span><span style="color:#005CC5;">input</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">wire</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">model</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;username&quot;</span></span>
<span class="line"><span style="color:#24292E;">           </span><span style="color:#D73A49;">class=</span><span style="color:#032F62;">&quot;...&quot;</span></span>
<span class="line"><span style="color:#24292E;">           </span><span style="color:#005CC5;">id</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;username&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">type</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;username&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">value</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#D73A49;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">@</span><span style="color:#6F42C1;">error</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;username&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">&lt;</span><span style="color:#005CC5;">p</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class=</span><span style="color:#032F62;">&quot;text-sm text-red-600 space-y-1 mt-2&quot;</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">{{ $message }}</span><span style="color:#D73A49;">&lt;/</span><span style="color:#005CC5;">p</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">@</span><span style="color:#005CC5;">enderror</span></span>
<span class="line"><span style="color:#D73A49;">&lt;/</span><span style="color:#005CC5;">div</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><p><code>@error</code> 指令将显示名称字段的验证错误消息（如果有）。</p><p>但这样做的问题是，如果表单很长并且验证错误发生在不在窗口的地方，用户将无法看到错误消息，而这并不是一个好的用户体验。</p><p>这个问题可以借助 <a href="https://alpinejs.dev/directives/init" target="_blank" rel="noreferrer">Alpine.js</a> 来解决，正如 <a href="https://twitter.com/calebporzio/status/1725220835076534690" target="_blank" rel="noreferrer">Caleb Porzio 的推文</a>中所精确描述的那样。</p><p>因此可以做的是，可以在错误消息容器上添加 <code>x-init</code> 指令，然后调用一个方法，如果错误消息容器在页面上可见，则将页面滚动到错误消息容器。</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line"><span style="color:#F97583;">@</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;username&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;">p</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">class=</span><span style="color:#9ECBFF;">&quot;text-sm text-red-600 space-y-1 mt-2&quot;</span></span>
<span class="line diff add"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">x</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">init</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">$el</span><span style="color:#9ECBFF;">.closest(&#39;form&#39;).scrollIntoView()&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        {{ $message }}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;/</span><span style="color:#79B8FF;">p</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">@</span><span style="color:#79B8FF;">enderror</span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line"><span style="color:#D73A49;">@</span><span style="color:#6F42C1;">error</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;username&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;</span><span style="color:#005CC5;">p</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">class=</span><span style="color:#032F62;">&quot;text-sm text-red-600 space-y-1 mt-2&quot;</span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#005CC5;">x</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">init</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">$el</span><span style="color:#032F62;">.closest(&#39;form&#39;).scrollIntoView()&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        {{ $message }}</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;/</span><span style="color:#005CC5;">p</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">@</span><span style="color:#005CC5;">enderror</span></span></code></pre></div><p>如果错误消息容器在页面上可见，<code>x-init</code> 指令中的代码会将页面滚动到最近的表单元素。</p><p>这样，用户将能够看到所有验证错误，即使它们不在窗口中。</p>`,12),t=[e];function r(c,y,i,E,F,d){return a(),n("div",null,t)}const m=s(o,[["render",r]]);export{C as __pageData,m as default};
